---
created: 2024-05-18T09:54
draft: true
tags:
- diary
---



enhance input plugin

本身是一个 plugin，在插件列表开启
在原有输入系统上子类化进行拓展，在配置中进行替换

project settings - input  - default classes

![[Pasted image 20240517222918.png]]

playerinput -> enhancedplayerinput
inputcomponent -> enhancedinputcomponent


player input, convert input from player into data that actors use


核心概念

input component IC

component insert in actor

input action IA

连接输入系统和项目逻辑的中间层
代表输入的抽象
对项目层屏蔽具体按键
并给予输入以逻辑上的语义，如 jump move fire之类
定义了 character 所能被玩家操纵的行为

ia 有 value type
- bool
- axis 1d float
- 2d vector2d
- 3d

trigger state
action 当前的 state
- triggered
	- 完成了所有 trigger 要求的条件，触发
- started
	- 在 trigger 执行之前
- ongoing
	- trigger 还在处理中
- completed
	- trigger 条件结束
- canceled
	- 中途结束

input mapping context IMC

代表按键到 IA 的映射关系

可以在运行时添加，删除，修改优先级

同样的按键输入，先被高优先级的 IMC 处理为 IA
如果存在 映射，则消费 输入
如果不存在映射，则继续转入低优先级的 imc 寻找映射

根据cha的不同状态，相同的输入有不同的反应
相同的动作，可映射不同的输入

input modifier IM

可以在两个地方添加
- imc，只针对当前 imc
- ia，全局生效

pre process raw input received from engine, before sending to trigger

多个 im 呈现 pipeline，前一个的输出，为后一个的输入

raw input -> raw input



- dead zone
- scalar, multiply a scalar value
- scalar by delta time
- negate
- smooth, smooth in multi frames
- response curve exponential?
- response curve user?
- fovscaling?
- toworldspace?
- swizzle input axis?
- collection?

input trigger IT

在经过 im 的处理之后，决定这个输入是否能 activate ia

在 imc 中设置

3 types
- explicit
- implicit
- blocker

在处理输入之后，返回状态可能是
- none
	- condition 未满足，fail
- ongoing
	- 部分满足，正在处理中
- triggered
	- 所有条件满足，suc


- down, value > 0.5(default)
- pressed, none to tri
- released, tri to none
- hold, 
- hold and release, 
- tap, 
- pulse, 
- chorded, chain
- combo


player mappable input config  PMI




platform settings

subclass enhanced input platform data



config
```ini
[/Script/EngineSettings.ConsoleSettings]
+ManualAutoCompleteList=(Command="ShowDebug EnhancedInput",Desc="Displays debug information about the current state of any Enhanced Input Mapping Contexts")
+ManualAutoCompleteList=(Command="ShowDebug WorldSubsystemInput",Desc="Displays debug information about the current state of any Enhanced Input Mapping Contexts applied to the Enhanced Input world subsystem.")
+ManualAutoCompleteList=(Command="ShowDebug InputSettings",Desc="Displays debug information any user input settings, such as player mappable keys.")
```







- [ ] module 在 uplugin 中的定义
	- type
	- loadingphase


- [ ] final 用于 struct


## Player Mappable Input Config (PMI)
 
Mappable configs are a collection of Input Mapping Contexts that represent one "Config" or "Preset" of mappings. For example, you can have a "Default" and a "Southpaw" mappable config that holds different input mapping contexts for aiming.  
 
You can use these configs to predefine a set of contexts and their priorities to add them all at once instead of having to manually add an array of input mapping contexts. Mappings provide various selections of metadata options that can make programming UI settings screens easier. 
 
## Debug Commands
 
There are several input related debug commands available to help you debug any input-related behavior you may be working on.
 
Using the command  `showdebug enhancedinput` displays the available input action and axis mappings used by your project.
 
![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/3063ead7-524f-48c6-b4c1-9de07fcc9eb4/image_15.png){:width="600"}
 
Using the command: showdebug devices 
 
![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/59f28366-2395-4722-af0f-105ace55e3c8/image_16.png){:width="600"}
 
## Injecting Input
 
Enhanced Input also brings along the concept of "Injecting Input" to your player. This provides the means for you to call a function in Blueprints, C++, or use a console command to simulate input on your player.  You can use the `Input.+key` console command to start simulating input. 
 
Below is an example of setting the `Gamepad_Left2D` key:


The key name is whatever the actual FKey name is, which you can find in the `InputCoreTypes.cpp` file, or in the key picker widget if you remove the spaces in the displayed key name. 
	 
![](https://d1iv7db44yhgxn.cloudfront.net/documentation/images/93da3603-f70d-4191-a33e-59a907d2833b/image_17.png){:width="600"}
 
Injecting input in Blueprints





- [ ] subsystem




- data asset 类
	- data asset 是 uobject 的子类
	- 要新建 data asset 资产，需要先子类 u data asset，新建时选择相应子类
	- 相当于 uasset 中存放的是相应 data asset 子类的对象
	- 纯数据
	- 在使用时，可以再加载回内存
	- [ ] 只能纯数据吗
	- [ ] primary data asset 类
	- 可以绕过 udataasset 直接从 uobject 继承并生成资产吗
		- 理论上可以
		- 多出 data asset 这一步，是一个整体的分类，约定
		- 都使用 data asset 这个类来做
		- 在 editor 中通过这个类来创建资产
	- [ ] 和 Data Only Blueprint Classes 的区别
		- 继承性
		- 数据在 cdo 中？


- bp 是一种特殊的 asset
	- asset 是序列化的结果
	- 只存储数据
	- bp 将 graph 编译成字节码，将程序编译成数据，就可以序列化到 asset 中








- [ ] uobject flags 的作用
	- 创建 data asset 使用 3 个
	- public
	- standalone
	- transactional

序列化，只存储数据，不存储代码逻辑
只存储类中的数据字段，不存储方法

一条线，是 uobject 派生的子类，actor, component, 等
一条线，是反射子类，uclass, ustruct，同样派生于 uobject

序列化的对象，都来自于以上的类对象



工作的平行分解
- 最小依赖原则
- 在测试 gameplay 的时候，真的需要人物模型完整吗？需要地形完备吗？
- 测试人物对战时，最重要关心动画
	- 模型可以使用粗模
	- 地形可以使用粗模
	- 动画要时时更新
		- blender rig ue skeleton
		- export mesh and anim to ue update